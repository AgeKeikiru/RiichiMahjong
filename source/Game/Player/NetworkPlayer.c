/* NetworkPlayer.c generated by valac 0.12.0, the Vala compiler
 * generated from NetworkPlayer.vala, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <float.h>
#include <math.h>
#include <stdlib.h>
#include <string.h>


#define TYPE_PLAYER (player_get_type ())
#define PLAYER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_PLAYER, Player))
#define PLAYER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_PLAYER, PlayerClass))
#define IS_PLAYER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_PLAYER))
#define IS_PLAYER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_PLAYER))
#define PLAYER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_PLAYER, PlayerClass))

typedef struct _Player Player;
typedef struct _PlayerClass PlayerClass;
typedef struct _PlayerPrivate PlayerPrivate;

#define TYPE_TILE (tile_get_type ())
#define TILE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_TILE, Tile))
#define TILE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_TILE, TileClass))
#define IS_TILE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_TILE))
#define IS_TILE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_TILE))
#define TILE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_TILE, TileClass))

typedef struct _Tile Tile;
typedef struct _TileClass TileClass;

#define TYPE_CALL_ACTION (call_action_get_type ())
#define CALL_ACTION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_CALL_ACTION, CallAction))
#define CALL_ACTION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_CALL_ACTION, CallActionClass))
#define IS_CALL_ACTION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_CALL_ACTION))
#define IS_CALL_ACTION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_CALL_ACTION))
#define CALL_ACTION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_CALL_ACTION, CallActionClass))

typedef struct _CallAction CallAction;
typedef struct _CallActionClass CallActionClass;

#define TYPE_TURN_ACTION (turn_action_get_type ())
#define TURN_ACTION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_TURN_ACTION, TurnAction))
#define TURN_ACTION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_TURN_ACTION, TurnActionClass))
#define IS_TURN_ACTION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_TURN_ACTION))
#define IS_TURN_ACTION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_TURN_ACTION))
#define TURN_ACTION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_TURN_ACTION, TurnActionClass))

typedef struct _TurnAction TurnAction;
typedef struct _TurnActionClass TurnActionClass;

#define TYPE_NETWORK_PLAYER (network_player_get_type ())
#define NETWORK_PLAYER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_NETWORK_PLAYER, NetworkPlayer))
#define NETWORK_PLAYER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_NETWORK_PLAYER, NetworkPlayerClass))
#define IS_NETWORK_PLAYER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_NETWORK_PLAYER))
#define IS_NETWORK_PLAYER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_NETWORK_PLAYER))
#define NETWORK_PLAYER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_NETWORK_PLAYER, NetworkPlayerClass))

typedef struct _NetworkPlayer NetworkPlayer;
typedef struct _NetworkPlayerClass NetworkPlayerClass;
typedef struct _NetworkPlayerPrivate NetworkPlayerPrivate;

#define TYPE_GAME_CONNECTION (game_connection_get_type ())
#define GAME_CONNECTION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_GAME_CONNECTION, GameConnection))
#define GAME_CONNECTION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_GAME_CONNECTION, GameConnectionClass))
#define IS_GAME_CONNECTION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_GAME_CONNECTION))
#define IS_GAME_CONNECTION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_GAME_CONNECTION))
#define GAME_CONNECTION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_GAME_CONNECTION, GameConnectionClass))

typedef struct _GameConnection GameConnection;
typedef struct _GameConnectionClass GameConnectionClass;
#define _game_connection_unref0(var) ((var == NULL) ? NULL : (var = (game_connection_unref (var), NULL)))

#define PLAYER_TYPE_PLAYER_STATE (player_player_state_get_type ())

struct _Player {
	GObject parent_instance;
	PlayerPrivate * priv;
	gfloat hand_height;
};

struct _PlayerClass {
	GObjectClass parent_class;
	void (*draw_tile) (Player* self, Tile* t);
	gboolean (*call_decision) (Player* self, Tile* discard_tile, gboolean can_chi);
	gboolean (*turn_decision) (Player* self);
	void (*arrange_hand) (Player* self);
	CallAction* (*get_call_action) (Player* self);
	void (*set_call_action) (Player* self, CallAction* value);
	TurnAction* (*get_turn_action) (Player* self);
	void (*set_turn_action) (Player* self, TurnAction* value);
};

struct _NetworkPlayer {
	Player parent_instance;
	NetworkPlayerPrivate * priv;
};

struct _NetworkPlayerClass {
	PlayerClass parent_class;
};

struct _NetworkPlayerPrivate {
	GameConnection* connection;
};

typedef enum  {
	PLAYER_PLAYER_STATE_READY,
	PLAYER_PLAYER_STATE_DECIDING,
	PLAYER_PLAYER_STATE_WAITING_PON,
	PLAYER_PLAYER_STATE_WAITING_KAN,
	PLAYER_PLAYER_STATE_WAITING_CHI
} PlayerPlayerState;


static gpointer network_player_parent_class = NULL;

GType player_get_type (void) G_GNUC_CONST;
GType tile_get_type (void) G_GNUC_CONST;
gpointer call_action_ref (gpointer instance);
void call_action_unref (gpointer instance);
GParamSpec* param_spec_call_action (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void value_set_call_action (GValue* value, gpointer v_object);
void value_take_call_action (GValue* value, gpointer v_object);
gpointer value_get_call_action (const GValue* value);
GType call_action_get_type (void) G_GNUC_CONST;
gpointer turn_action_ref (gpointer instance);
void turn_action_unref (gpointer instance);
GParamSpec* param_spec_turn_action (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void value_set_turn_action (GValue* value, gpointer v_object);
void value_take_turn_action (GValue* value, gpointer v_object);
gpointer value_get_turn_action (const GValue* value);
GType turn_action_get_type (void) G_GNUC_CONST;
GType network_player_get_type (void) G_GNUC_CONST;
gpointer game_connection_ref (gpointer instance);
void game_connection_unref (gpointer instance);
GParamSpec* param_spec_game_connection (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void value_set_game_connection (GValue* value, gpointer v_object);
void value_take_game_connection (GValue* value, gpointer v_object);
gpointer value_get_game_connection (const GValue* value);
GType game_connection_get_type (void) G_GNUC_CONST;
#define NETWORK_PLAYER_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), TYPE_NETWORK_PLAYER, NetworkPlayerPrivate))
enum  {
	NETWORK_PLAYER_DUMMY_PROPERTY
};
static void network_player_net_call_action (NetworkPlayer* self, CallAction* action);
static void _network_player_net_call_action_game_connection_call_action (GameConnection* _sender, CallAction* action, gpointer self);
static void network_player_net_turn_action (NetworkPlayer* self, TurnAction* action);
static void _network_player_net_turn_action_game_connection_turn_action (GameConnection* _sender, TurnAction* action, gpointer self);
NetworkPlayer* network_player_new (gint position, GameConnection* connection);
NetworkPlayer* network_player_construct (GType object_type, gint position, GameConnection* connection);
const gchar* game_connection_get_name (GameConnection* self);
Player* player_new (gint position, const gchar* name);
Player* player_construct (GType object_type, gint position, const gchar* name);
void player_set_call_action (Player* self, CallAction* value);
GType player_player_state_get_type (void) G_GNUC_CONST;
void player_set_state (Player* self, PlayerPlayerState value);
void player_set_turn_action (Player* self, TurnAction* value);
TurnAction* player_get_turn_action (Player* self);
static void network_player_finalize (GObject* obj);


static void _network_player_net_call_action_game_connection_call_action (GameConnection* _sender, CallAction* action, gpointer self) {
	network_player_net_call_action (self, action);
}


static void _network_player_net_turn_action_game_connection_turn_action (GameConnection* _sender, TurnAction* action, gpointer self) {
	network_player_net_turn_action (self, action);
}


static gpointer _game_connection_ref0 (gpointer self) {
	return self ? game_connection_ref (self) : NULL;
}


NetworkPlayer* network_player_construct (GType object_type, gint position, GameConnection* connection) {
	NetworkPlayer * self = NULL;
	const gchar* _tmp0_ = NULL;
	GameConnection* _tmp1_;
	g_return_val_if_fail (connection != NULL, NULL);
	_tmp0_ = game_connection_get_name (connection);
	self = (NetworkPlayer*) player_construct (object_type, position, _tmp0_);
	g_signal_connect_object (connection, "call-action", (GCallback) _network_player_net_call_action_game_connection_call_action, self, 0);
	g_signal_connect_object (connection, "turn-action", (GCallback) _network_player_net_turn_action_game_connection_turn_action, self, 0);
	_tmp1_ = _game_connection_ref0 (connection);
	_game_connection_unref0 (self->priv->connection);
	self->priv->connection = _tmp1_;
	return self;
}


NetworkPlayer* network_player_new (gint position, GameConnection* connection) {
	return network_player_construct (TYPE_NETWORK_PLAYER, position, connection);
}


static void network_player_net_call_action (NetworkPlayer* self, CallAction* action) {
	g_return_if_fail (self != NULL);
	g_return_if_fail (action != NULL);
	g_print ("Got call action!");
	player_set_call_action ((Player*) self, action);
	player_set_state ((Player*) self, PLAYER_PLAYER_STATE_READY);
}


static void network_player_net_turn_action (NetworkPlayer* self, TurnAction* action) {
	TurnAction* _tmp0_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (action != NULL);
	g_print ("Got turn action!");
	player_set_turn_action ((Player*) self, action);
	_tmp0_ = player_get_turn_action ((Player*) self);
	if (_tmp0_ != NULL) {
		player_set_state ((Player*) self, PLAYER_PLAYER_STATE_READY);
	}
}


static void network_player_class_init (NetworkPlayerClass * klass) {
	network_player_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (NetworkPlayerPrivate));
	G_OBJECT_CLASS (klass)->finalize = network_player_finalize;
}


static void network_player_instance_init (NetworkPlayer * self) {
	self->priv = NETWORK_PLAYER_GET_PRIVATE (self);
}


static void network_player_finalize (GObject* obj) {
	NetworkPlayer * self;
	guint _tmp0_;
	guint _tmp1_;
	self = NETWORK_PLAYER (obj);
	g_signal_parse_name ("call-action", TYPE_GAME_CONNECTION, &_tmp0_, NULL, FALSE);
	g_signal_handlers_disconnect_matched (self->priv->connection, G_SIGNAL_MATCH_ID | G_SIGNAL_MATCH_FUNC | G_SIGNAL_MATCH_DATA, _tmp0_, 0, NULL, (GCallback) _network_player_net_call_action_game_connection_call_action, self);
	g_signal_parse_name ("turn-action", TYPE_GAME_CONNECTION, &_tmp1_, NULL, FALSE);
	g_signal_handlers_disconnect_matched (self->priv->connection, G_SIGNAL_MATCH_ID | G_SIGNAL_MATCH_FUNC | G_SIGNAL_MATCH_DATA, _tmp1_, 0, NULL, (GCallback) _network_player_net_turn_action_game_connection_turn_action, self);
	_game_connection_unref0 (self->priv->connection);
	G_OBJECT_CLASS (network_player_parent_class)->finalize (obj);
}


GType network_player_get_type (void) {
	static volatile gsize network_player_type_id__volatile = 0;
	if (g_once_init_enter (&network_player_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (NetworkPlayerClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) network_player_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (NetworkPlayer), 0, (GInstanceInitFunc) network_player_instance_init, NULL };
		GType network_player_type_id;
		network_player_type_id = g_type_register_static (TYPE_PLAYER, "NetworkPlayer", &g_define_type_info, 0);
		g_once_init_leave (&network_player_type_id__volatile, network_player_type_id);
	}
	return network_player_type_id__volatile;
}



